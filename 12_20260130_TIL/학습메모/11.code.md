```js
<%@page import="java.util.UUID"%>
<%-- 고유 식별자(UUID) 생성을 위한 클래스를 가져옵니다. --%>
<%@page import="java.net.URLEncoder"%>
<%-- URL 인코딩을 위한 클래스를 가져옵니다. --%>
<%@page import="shop.dto.User"%>
<%-- 사용자 정보를 담는 User DTO 클래스를 가져옵니다. --%>
<%@page import="shop.dao.UserRepository"%>
 <%-- 데이터베이스 접근을 위한 UserRepository 클래스를 가져옵니다. --%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%> <%-- 페이지 언어 설정 및 인코딩 방식을 UTF-8로 지정합니다. --%>
    
<%
    String id = request.getParameter("id");	
    // 클라이언트가 전송한 "id" 파라미터 값을 가져와 변수에 저장합니다.
    String pw = request.getParameter("pw");
    // 클라이언트가 전송한 "pw" 파라미터 값을 가져와 변수에 저장합니다.
    String rememberId = request.getParameter("rememberId");
    // "아이디 저장" 체크박스 선택 여부를 가져옵니다.
    String autoLogin = request.getParameter("autoLogin");
    // "자동 로그인" 체크박스 선택 여부를 가져옵니다.
    
    UserRepository userDAO = new UserRepository();
    // DB 연동을 위해 UserRepository 객체를 생성합니다.
    User loginUser = userDAO.login(id, pw);
    // 입력받은 id와 pw를 사용하여 DB에서 일치하는 회원을 조회합니다.
    
    // TODO: 로그인 실패 처리
    if( loginUser == null ) { // 조회된 회원 정보가 없으면 (로그인 실패)
        // 실패 메시지(-1)를 쿼리 스트링에 담아 다시 로그인 페이지로 리다이렉트합니다.
        response.sendRedirect("login.jsp?msg=-1");
        return; // 이후 코드가 실행되지 않도록 강제 종료합니다.
    }
    
    // TODO: 로그인 성공 처리
    // - 세션에 로그인 정보 등록
    // 세션은 브라우저가 종료되기 전까지 서버에 정보를 유지하여 로그인 상태를 기억합니다.
    session.setAttribute("loginId", id); // 세션에 현재 로그인한 아이디를 저장합니다.
    session.setAttribute("loginUser", loginUser); // 세션에 로그인한 사용자의 전체 객체 정보를 저장합니다.
    
    // - 주문목록(orderList) 초기화
    // 새로운 사용자가 로그인했으므로 기존 세션에 남아있을 수 있는 장바구니/주문 목록을 초기화합니다.
    session.setAttribute("orderList", null);
    
    // TODO: 아이디 저장 (쿠키 사용)
    // 사용자의 로컬 컴퓨터에 정보를 저장하여 다음에 브라우저를 켤 때 기억하게 합니다.
    if( rememberId != null && rememberId.equals("on") ) { // "아이디 저장"에 체크했다면
        Cookie cookie = new Cookie("rememberId", id); // 쿠키 이름을 "rememberId", 값을 현재 아이디로 생성합니다.
        cookie.setMaxAge(60 * 60 * 24 * 7); // 쿠키 유효 기간을 7일(초 단위 계산)로 설정합니다.
        cookie.setPath("/"); // 쿠키가 전체 경로에서 유효하도록 설정합니다.
        response.addCookie(cookie); // 생성한 쿠키를 클라이언트의 브라우저에 전송하여 저장합니다.
    } else { // "아이디 저장"을 체크하지 않았거나 해제했다면
        // 기존에 저장된 쿠키를 삭제하기 위해 값이 빈 문자열인 쿠키를 생성합니다.
        Cookie cookie = new Cookie("rememberId", "");
        cookie.setMaxAge(0); // 유효 기간을 0으로 설정하여 즉시 소멸되게 합니다.
        cookie.setPath("/");
        response.addCookie(cookie); // 클라이언트에 전송하여 기존 쿠키를 무효화합니다.
    }
    
    // TODO: 자동 로그인 처리
    // 브라우저를 닫았다가 다시 열어도 로그인 상태를 유지하게 하는 기능입니다.
    if( autoLogin != null && autoLogin.equals("on") ) { // "자동 로그인"에 체크했다면
        // DB에서 새로운 토큰을 생성하거나 갱신하여 가져옵니다.
        String token = userDAO.refreshToken(id); 
        Cookie cookie = new Cookie("token", token); // 생성된 토큰을 쿠키에 담습니다.
        cookie.setMaxAge(60 * 60 * 24 * 7); // 토큰 쿠키의 유효 기간을 7일로 설정합니다.
        cookie.setPath("/");
        response.addCookie(cookie); // 토큰이 담긴 쿠키를 브라우저에 저장합니다.
    }

    // TODO: 로그인 완료 후 이동
    // 모든 처리가 끝나면 성공 코드(msg=0)를 담아 완료 페이지로 이동시킵니다.
    response.sendRedirect("complete.jsp?msg=0");		
%>



<!--a href="{ root }/admin/product/list/jsp"뜻: 관리자 상품 목록 페이지로 이동하는 링크
    - { root }: 웹 애플리케이션의 루트 경로를 나타냄
    - /admin/product/list.jsp: 관리자용 상품 목록 페이지의 경로-->
